<p id="notice"><%= notice %></p>

<h1>Appointments</h1>
<%= search_form_for @q do |f| %>
  <%= f.label :appointment_date_cont %>
  <%= f.search_field :appointment_date_cont %><br />
  <%= f.submit%>
<% end %>
<table>
  <thead>
    <tr>
      <th>Appointment date</th>
      <th>Appointment time</th>
      <th>Doctor patient</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @appointments.each do |appointment| %>
      <% if current_user&.doctor? %>
        <% if appointment.user.id == current_user.id %>
          <tr>
            <td><%= appointment.appointment_date %></td>
            <td><%= appointment.appointment_time %></td>
            <td><%= appointment.user.id %></td>
            <td><%= link_to 'Show', appointment %></td>
            <td><%= link_to 'Edit', edit_appointment_path(appointment) %></td>
            <td><%= link_to 'Destroy', appointment, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          </tr>
        <% end %>
      <% else %>
        <% if appointment.id == current_user.id %>
            <tr>
              <td><%= appointment.appointment_date %></td>
              <td><%= appointment.appointment_time %></td>
              <td><%= appointment.user.id %></td>
              <td><%= link_to 'Show', appointment %></td>
              <td><%= link_to 'Edit', edit_appointment_path(appointment) %></td>
              <td><%= link_to 'Destroy', appointment, method: :delete, data: { confirm: 'Are you sure?' } %></td>
            </tr>
          <% end %>
        <% end %>
      <% end %>
 
  </tbody>
</table>

<%= paginate @appointments %>
<br>
<% if can? :create, @appointment %>
<%= link_to 'New Appointment', new_appointment_path %>
<% end %>